{# ****************************************************************************************************************** #}
{# *** STYLES *** #}
{# ****************************************************************************************************************** #}
{{ block styles }}
    <link href="{{ static 'bret/css/custom.css' }}" rel="stylesheet"/>
    <style>
        .otree-title {
            text-align: left;
        }
        .otree-btn-next {
            display: block;
        }
    </style>
{{ endblock }}


{# ****************************************************************************************************************** #}
{# *** TITLE *** #}
{# ****************************************************************************************************************** #}
{{ block title }}
    Results
{{ endblock }}


{# ****************************************************************************************************************** #}
{# *** CONTENT *** #}
{# ****************************************************************************************************************** #}
{{ block content }}

    <!-- ----------------------------------------------------------------------------------------------------------- -->
    <!-- information about results -->
    <!-- ----------------------------------------------------------------------------------------------------------- -->
    {{ if Constants.num_rounds == 1 }}
        <div class="text-start">
            <p>
                You chose to collect {{ boxes_collected }} out of {{ boxes_total }} boxes.
            </p>

            <p>
                The bomb was hidden behind the box in row {{ bomb_row }}, column {{ bomb_col }}.
            </p>

            {{ if bomb }}
                <p>
                    The bomb was among your {{ boxes_collected }} collected boxes.<br/>
                    Accordingly, all your earnings in this task were destroyed and your payoff amounts to {{ payoff }}.
                </p>
            {{ else }}
                <p>
                    Your collected boxes did not contain the bomb.<br/>
                    Thus, you receive {{ box_value }} for each of the {{ boxes_collected }} boxes
                    you collected such that your payoff from this task amounts to <b>{{ payoff }}</b>.
                </p>
            {{ endif }}
        </div>

    {{ else }}
        <p>
            The table below summarizes the results of your decisions in the {{ Constants.num_rounds }} rounds played.
        </p>
    {{ endif }}


    <!-- ----------------------------------------------------------------------------------------------------------- -->
    <!-- history table -->
    <!-- ----------------------------------------------------------------------------------------------------------- -->
    {{ if Constants.num_rounds > 1 }}
        <div>
            <p>
                <b>Round History</b>
            </p>

            <div class="table-responsive">
                <table class="table">
                    <tr>
                        <th>Round No.</th>
                        <th>No. of Boxes Collected</th>
                        <th>Bomb Collected</th>
                        <th>Round Payoff</th>
                    </tr>
                    {{ for p in player_in_all_rounds }}
                    <tr>
                        <td>{{ p.subsession.round_number }}</td>
                        <td>{{ p.boxes_collected }}</td>
                        <td>
                            {{ if p.bomb }}
                                Yes
                            {{ else }}
                                No
                            {{ endif }}
                        </td>
                        <td>{{ p.round_result }}</td>
                    </tr>
                    {{ endfor }}
                </table>
            </div>
        </div>

        <div>
        {{ if Constants.random_payoff }}
            <p>
                For your payment, round number {{ round_to_pay }} was randomly chosen. <br/>
                Thus, your final payoff in this task amounts to {{ total_payoff }}.
            </p>
        {{ else }}
            <p>
                Your final payoff is determined by the sum of all payoffs per round
                such that you final payoff in this task amounts to {{ total_payoff }}.
            </p>
        {{ endif }}
        </div>
    {{ endif }}

    <br/>
    {{ next_button }}

{{ endblock }}
